{% extends "base.html" %}

{% block title %}Leaderboard - Match Maker{% endblock %}
{% block body_class %}leaderboard{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/leaderboard.css') }}">
{% endblock %}

{% block intro %}
<div class="intro intro-with-icon">
  <span>Leaderboard</span>
  {% if not event_completed %}
    <a href="{{ request.referrer or url_for('drawing') }}" class="intro-icon-link" aria-label="Go back">
      <img src="{{ url_for('static', filename='images/back_to.svg') }}" alt="Back" class="intro-icon">
    </a>
  {% endif %}
</div>
{% endblock %}

{% block content %}
  <div class="leaderboard-wrapper">
    {% if game_name %}
      <h2 class="board-title">
        {{ game_name }}{% if game_place %} | {{ game_place }}{% endif %}
        {% if game_date %}
          <br>
          {{ game_date.strftime('%d %b %Y') }}
        {% endif %}
      </h2>
    {% endif %}

    {% if leaderboard %}
      <table class="leaderboard-table">
        <thead>
          <tr>
            <th class="col-rank"></th>
            <th class="col-player"></th>
            <th class="col-record">G-W-L</th>
            <th class="col-diff">Diff</th>
            <th class="col-points">P</th>
          </tr>
        </thead>
        <tbody>
          {% for row in leaderboard %}
            <tr>
              <td class="col-rank">
                {% if row.rank == 1 %}
                  <img src="{{ url_for('static', filename='images/King.svg') }}" alt="Rank 1" class="rank-icon">
                {% else %}
                  {{ row.rank }}
                {% endif %}
              </td>
              <td class="col-player">
                {% if event_completed %}
                  <a href="{{ url_for('player_stats_view', player_id=row.player_id) }}" class="player-link">{{ row.player_name }}</a>
                {% else %}
                  {{ row.player_name }}
                {% endif %}
              </td>
              <td class="col-record">{{ row.games }}-{{ row.wins }}-{{ row.losses }}</td>
              <td class="col-diff">{{ '%+d'|format(row.point_diff) }}</td>
              <td class="col-points">{{ row.points }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="empty-state">No completed games yet. Come back after the first match!</p>
    {% endif %}
  </div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/leaderboard.js') }}"></script>
{% endblock %}

